DROP TABLE IF EXISTS users, phones CASCADE;

CREATE TABLE users (
       id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
       name VARCHAR(255) NOT NULL,
       email VARCHAR(255) NOT NULL UNIQUE,
       password VARCHAR(255) NOT NULL,
       created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
       modified TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
       last_login TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
       token VARCHAR(255),
       is_active BOOLEAN NOT NULL DEFAULT TRUE
);

CREATE TABLE phones (
        id  BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
        number VARCHAR(15) NOT NULL,
        city_code VARCHAR(5) NOT NULL,
        country_code VARCHAR(5) NOT NULL,
        user_id UUID REFERENCES users(id) ON DELETE CASCADE
);

CREATE INDEX idx_users_email ON users(email);